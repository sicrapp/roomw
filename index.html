<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à - ‡πÇ‡∏ñ‡∏á‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            font-family: 'Kanit', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #ff9a56 0%, #ff6b35 50%, #f12711 100%);
        }
        
        .card-shadow {
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.2);
        }
        
        .rating-option {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .rating-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }
        
        .rating-option.selected {
            background: linear-gradient(135deg, #ff6b35, #f12711);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.4);
        }
        
        .image-preview {
            position: relative;
            display: inline-block;
            margin: 10px;
        }
        
        .remove-image {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #ff6b35;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .success-animation {
            animation: bounce 0.6s ease-in-out;
        }
        
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translate3d(0,0,0);
            }
            40%, 43% {
                transform: translate3d(0, -10px, 0);
            }
            70% {
                transform: translate3d(0, -5px, 0);
            }
            90% {
                transform: translate3d(0, -2px, 0);
            }
        }
    </style>
</head>
<body class="min-h-screen gradient-bg">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-2">üìã ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</h1>
            <p class="text-xl text-orange-100">‡πÇ‡∏ñ‡∏á‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à</p>
        </div>

        <!-- Main Form -->
        <div class="max-w-4xl mx-auto bg-white rounded-3xl card-shadow p-8">
            <form id="evaluationForm">
                <!-- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î -->
                <div class="mb-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">üßπ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î</h3>
                    <div class="grid grid-cols-5 gap-2">
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="cleanliness" data-value="‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î">
                            <div class="text-xl mb-1">ü•∞</div>
                            <div class="text-xs font-medium">‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="cleanliness" data-value="‡∏°‡∏≤‡∏Å">
                            <div class="text-xl mb-1">üòÑ</div>
                            <div class="text-xs font-medium">‡∏°‡∏≤‡∏Å</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="cleanliness" data-value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">
                            <div class="text-xl mb-1">üôÇ</div>
                            <div class="text-xs font-medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="cleanliness" data-value="‡∏ô‡πâ‡∏≠‡∏¢">
                            <div class="text-xl mb-1">üòî</div>
                            <div class="text-xs font-medium">‡∏ô‡πâ‡∏≠‡∏¢</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="cleanliness" data-value="‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á">
                            <div class="text-xl mb-1">üò§</div>
                            <div class="text-xs font-medium">‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</div>
                        </div>
                    </div>
                </div>

                <!-- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå -->
                <div class="mb-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">üîß ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h3>
                    <div class="grid grid-cols-5 gap-2">
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="equipment" data-value="‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î">
                            <div class="text-xl mb-1">ü•∞</div>
                            <div class="text-xs font-medium">‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="equipment" data-value="‡∏°‡∏≤‡∏Å">
                            <div class="text-xl mb-1">üòÑ</div>
                            <div class="text-xs font-medium">‡∏°‡∏≤‡∏Å</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="equipment" data-value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">
                            <div class="text-xl mb-1">üôÇ</div>
                            <div class="text-xs font-medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="equipment" data-value="‡∏ô‡πâ‡∏≠‡∏¢">
                            <div class="text-xl mb-1">üòî</div>
                            <div class="text-xs font-medium">‡∏ô‡πâ‡∏≠‡∏¢</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="equipment" data-value="‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á">
                            <div class="text-xl mb-1">üò§</div>
                            <div class="text-xs font-medium">‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</div>
                        </div>
                    </div>
                </div>

                <!-- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏° -->
                <div class="mb-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">üíù ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°</h3>
                    <div class="grid grid-cols-5 gap-2">
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="overall" data-value="‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î">
                            <div class="text-xl mb-1">ü•∞</div>
                            <div class="text-xs font-medium">‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="overall" data-value="‡∏°‡∏≤‡∏Å">
                            <div class="text-xl mb-1">üòÑ</div>
                            <div class="text-xs font-medium">‡∏°‡∏≤‡∏Å</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="overall" data-value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">
                            <div class="text-xl mb-1">üôÇ</div>
                            <div class="text-xs font-medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="overall" data-value="‡∏ô‡πâ‡∏≠‡∏¢">
                            <div class="text-xl mb-1">üòî</div>
                            <div class="text-xs font-medium">‡∏ô‡πâ‡∏≠‡∏¢</div>
                        </div>
                        <div class="rating-option bg-gray-50 p-2 rounded-lg text-center border-2 border-transparent" data-question="overall" data-value="‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á">
                            <div class="text-xl mb-1">üò§</div>
                            <div class="text-xs font-medium">‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</div>
                        </div>
                    </div>
                </div>

                <!-- ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ -->
                <div class="mb-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">üí≠ ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</h3>
                    <textarea 
                        id="suggestions" 
                        rows="4" 
                        class="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-orange-400 focus:outline-none resize-none"
                        placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."
                    ></textarea>
                </div>

                <!-- ‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û -->
                <div class="mb-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">üì∑ ‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö</h3>
                    <div class="border-2 border-dashed border-gray-300 rounded-xl p-6">
                        <div class="text-center mb-4">
                            <input 
                                type="file" 
                                id="imageInput" 
                                multiple 
                                accept="image/*" 
                                class="hidden"
                            >
                            <button 
                                type="button" 
                                onclick="document.getElementById('imageInput').click()"
                                class="bg-gradient-to-r from-orange-400 to-orange-600 text-white px-6 py-3 rounded-xl font-medium hover:from-orange-500 hover:to-orange-700 transition-all duration-300"
                            >
                                üìÅ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                            </button>
                            <p class="text-gray-500 mt-2">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏∏‡∏Å‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</p>
                        </div>
                        <div id="imagePreview" class="flex flex-wrap justify-center gap-4"></div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="text-center">
                    <button 
                        type="submit" 
                        id="submitBtn"
                        class="bg-gradient-to-r from-orange-500 to-red-600 text-white px-12 py-4 rounded-2xl text-xl font-semibold hover:from-orange-600 hover:to-red-700 transition-all duration-300 transform hover:scale-105 shadow-lg"
                    >
                        ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
                    </button>
                </div>
            </form>
        </div>

        <!-- Status Modal -->
        <div id="statusModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-2xl p-8 max-w-md mx-4 text-center">
                <div id="statusContent"></div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let selectedRatings = {};
        let selectedImages = [];

        // Rating selection handler
        document.querySelectorAll('.rating-option').forEach(option => {
            option.addEventListener('click', function() {
                const question = this.dataset.question;
                const value = this.dataset.value;
                
                // Remove selected class from other options in the same question
                document.querySelectorAll(`[data-question="${question}"]`).forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Add selected class to clicked option
                this.classList.add('selected');
                
                // Store selection
                selectedRatings[question] = value;
            });
        });

        // Image handling
        document.getElementById('imageInput').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            
            files.forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const imageData = {
                            file: file,
                            dataUrl: e.target.result,
                            base64: e.target.result.split(',')[1],
                            name: file.name,
                            type: file.type
                        };
                        
                        selectedImages.push(imageData);
                        displayImagePreview(imageData, selectedImages.length - 1);
                    };
                    reader.readAsDataURL(file);
                }
            });
        });

        function displayImagePreview(imageData, index) {
            const previewContainer = document.getElementById('imagePreview');
            
            const imageDiv = document.createElement('div');
            imageDiv.className = 'image-preview';
            imageDiv.innerHTML = `
                <img src="${imageData.dataUrl}" alt="Preview" class="w-32 h-32 object-cover rounded-lg border-2 border-gray-200">
                <div class="remove-image" onclick="removeImage(${index})">√ó</div>
                <p class="text-sm text-gray-600 mt-1 text-center max-w-32 truncate">${imageData.name}</p>
            `;
            
            previewContainer.appendChild(imageDiv);
        }

        function removeImage(index) {
            selectedImages.splice(index, 1);
            refreshImagePreviews();
        }

        function refreshImagePreviews() {
            const previewContainer = document.getElementById('imagePreview');
            previewContainer.innerHTML = '';
            
            selectedImages.forEach((imageData, index) => {
                displayImagePreview(imageData, index);
            });
        }

        // Form submission
        document.getElementById('evaluationForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Validate required fields
            if (Object.keys(selectedRatings).length < 3) {
                showStatus('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠', '‚ùå');
                return;
            }

            // Show loading status
            showStatus('loading', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...', '<div class="loading-spinner mx-auto"></div>');

            try {
                // Prepare form data
                const formData = new URLSearchParams();
                formData.append('cleanliness', selectedRatings.cleanliness || '');
                formData.append('equipment', selectedRatings.equipment || '');
                formData.append('overall', selectedRatings.overall || '');
                formData.append('suggestions', document.getElementById('suggestions').value);
                formData.append('timestamp', new Date().toLocaleString('th-TH'));

                // Add images as base64
                if (selectedImages.length > 0) {
                    const imageDataArray = selectedImages.map(img => ({
                        base64: img.base64,
                        name: img.name,
                        type: img.type
                    }));
                    formData.append('images', JSON.stringify(imageDataArray));
                }

                // Submit to Google Apps Script
                const response = await fetch('https://script.google.com/macros/s/AKfycby2Go8W9aLrTlRRmTUUPdRFVtnThG8SghSXhUemYJKQnmXPK3VP1bOIWvoxtvUPfrU5Jg/exec', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    showStatus('success', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', '‚úÖ');
                    resetForm();
                } else {
                    throw new Error(result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                }

            } catch (error) {
                console.error('Error:', error);
                showStatus('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, '‚ùå');
            }
        });

        function showStatus(type, message, icon) {
            const modal = document.getElementById('statusModal');
            const content = document.getElementById('statusContent');
            
            let bgColor = '';
            let textColor = '';
            
            switch(type) {
                case 'loading':
                    bgColor = 'bg-blue-50';
                    textColor = 'text-blue-800';
                    break;
                case 'success':
                    bgColor = 'bg-green-50';
                    textColor = 'text-green-800';
                    break;
                case 'error':
                    bgColor = 'bg-red-50';
                    textColor = 'text-red-800';
                    break;
            }
            
            content.innerHTML = `
                <div class="${bgColor} p-6 rounded-xl">
                    <div class="text-4xl mb-4">${icon}</div>
                    <p class="${textColor} text-lg font-medium">${message}</p>
                </div>
            `;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            if (type === 'success') {
                content.firstElementChild.classList.add('success-animation');
                setTimeout(() => {
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                }, 3000);
            } else if (type === 'error') {
                setTimeout(() => {
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                }, 5000);
            }
        }

        function resetForm() {
            // Reset ratings
            selectedRatings = {};
            document.querySelectorAll('.rating-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Reset textarea
            document.getElementById('suggestions').value = '';
            
            // Reset images
            selectedImages = [];
            document.getElementById('imagePreview').innerHTML = '';
            document.getElementById('imageInput').value = '';
        }

        // Close modal on click outside
        document.getElementById('statusModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.add('hidden');
                this.classList.remove('flex');
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96e522e6c09c893a',t:'MTc1NTA1NTg1Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
